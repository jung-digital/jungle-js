function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function, not "+typeof i);t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(t,i):t.__proto__=i)}function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}var _get=function(t,i,e){for(var s=!0;s;){var n=t,o=i,a=e;r=l=h=void 0,s=!1,null===n&&(n=Function.prototype);var r=Object.getOwnPropertyDescriptor(n,o);if(void 0!==r){if("value"in r)return r.value;var h=r.get;return void 0===h?void 0:h.call(a)}var l=Object.getPrototypeOf(n);if(null===l)return void 0;t=l,i=o,e=a,s=!0}},_createClass=function(){function t(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(i,e,s){return e&&t(i.prototype,e),s&&t(i,s),i}}();!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):t.Embers=i()}(this,function(){"use strict";function t(t,i){return Math.random()*(i-t)+t}function i(i){return i[Math.floor(t(0,i.length-1e-6))]}function e(t,i){return t.y<i.y}function s(t,i){return t.y>i.y}function n(t,i){return t.x<i.x}function o(t,i){return t.x>i.x}function a(t){return(t-1+2)%4+1}function r(t,i){var a=[];return e(t,i)&&a.push(4),s(t,i)&&a.push(2),n(t,i)&&a.push(3),o(t,i)&&a.push(1),a}function h(t){return t==k.LEFT?new paper.Point(-1,0):t==k.RIGHT?new paper.Point(1,0):t==k.TOP?new paper.Point(0,-1):t==k.BOTTOM?new paper.Point(0,1):void 0}function l(i,e){var s=0;s=i==k.RIGHT?e.right:s,s=i==k.TOP||i==k.BOTTOM?t(0,e.right):s;var n=0;return n=i==k.BOTTOM?e.bottom:n,n=i==k.LEFT||i==k.RIGHT?t(0,e.bottom):n,new paper.Point(s,n)}function c(t,i,e){var s,n,o,a,r,h,l,c;if(0==i)h=l=c=e;else switch(t/=60,s=Math.floor(t),n=t-s,o=e*(1-i),a=e*(1-i*n),r=e*(1-i*(1-n)),s){case 0:h=e,l=r,c=o;break;case 1:h=a,l=e,c=o;break;case 2:h=o,l=e,c=r;break;case 3:h=o,l=a,c=e;break;case 4:h=r,l=o,c=e;break;default:h=e,l=o,c=a}return{r:h,g:l,b:c}}var p=function(){function t(i){_classCallCheck(this,t),this.id=i.id||-1,this.pathRedraw=i.pathRedraw,this.sparkLength=i.sparkLength||200,this.sparkResolution=i.sparkResolution||20,this.options=i,this.paths=[],this.sparking=!1}return _createClass(t,[{key:"reset",value:function(){this.sparking=!1}},{key:"spark",value:function(t){if(!this.sparking){for(var i in t)this.options[i]=t[i];this.onFrameCallback=t.onFrameCallback,this.velocity=t.velocity,this.sparking=!0,this.position=this.options.position,this.points=this.options.position?[this.options.position]:void 0}}},{key:"next",value:function(t){this.position=t,this.points=this.points||[],this.points.push(t),this.points.length>this.sparkResolution&&this.points.shift()}},{key:"onFrame",value:function(t,i){this.sparking&&(this.onFrameCallback&&this.onFrameCallback.call(this,t,i),this.updateTail(t,i))}},{key:"updateTail",value:function(t,i){if(this.points.length>1)for(var e=0;e<this.points.length-1;e++){var s=this.points[this.points.length-(e+1)],n=this.points[this.points.length-(e+2)];this.pathRedraw(this,s,n,e/(this.sparkResolution-1),t,i)}}}]),t}(),u=function x(){_classCallCheck(this,x),this.Spark=p},f=(new u,800),d=800/1.618,v=function(){function t(i,e,s){_classCallCheck(this,t),this.canvas=i,this.ctx=i.getContext("2d"),this.options=e||{},this.options.fillCanvas=this.options.fillCanvas===!1?!1:!0,this.lastTime=0,this.options.fillCanvas?this.resizeHandler():(this.canvasTargetWidth=this.width=this.options.width||f,this.canvasTargetHeight=this.height=this.options.width||d),window.addEventListener("resize",this.resizeHandler.bind(this)),i.addEventListener("mousemove",this.onMouseMoveHandler.bind(this)),i.addEventListener("mouseout",this.onMouseOutHandler.bind(this)),i.addEventListener("touchstart",this.onTouchStartHandler.bind(this)),i.addEventListener("touchmove",this.onTouchMoveHandler.bind(this)),i.setAttribute("width",f),i.setAttribute("height",d),s&&i.setAttribute("id",s),window.requestAnimationFrame(this._onFrameFirstHandler.bind(this))}return _createClass(t,[{key:"resizeHandler",value:function(t){if(this.options.fillCanvas){var i=window.innerWidth,e=window.innerHeight;console.log(this.canvas),this.canvas.width=this.canvas.style.width=this.canvasTargetWidth=this.width=i,this.canvas.height=this.canvas.style.height=this.canvasTargetHeight=this.height=e}else{var s=Math.min(800,window.innerWidth);this.canvas.style.width=this.canvasTargetWidth=s,this.canvas.style.height=this.canvasTargetHeight=s/1.618}this.resize()}},{key:"resize",value:function(){console.log("Resized!",this.canvasTargetWidth,this.canvasTargetHeight)}},{key:"onMouseMoveHandler",value:function(){}},{key:"onMouseOutHandler",value:function(){}},{key:"onTouchStartHandler",value:function(){}},{key:"onTouchMoveHandler",value:function(){}},{key:"_onFrameFirstHandler",value:function(t){this.lastTime=t,window.requestAnimationFrame(this._onFrameHandler.bind(this))}},{key:"_onFrameHandler",value:function(t){this.elapsed=(t-this.lastTime)/1e3,this.lastTime=t,this.onFrameHandler(this.elapsed),this.options.debug&&(this.ctx.font="12px Georgia white",this.ctx.fillStyle="white",this.ctx.fillText(this.debugText,10,50)),window.requestAnimationFrame(this._onFrameHandler.bind(this))}},{key:"debugText",get:function(){return this.canvas.width+", "+this.canvas.height+" FPS: "+Math.round(1/this.elapsed)}}]),t}(),k={LEFT:1,TOP:2,RIGHT:3,BOTTOM:4,ran:function(){return Math.floor(t(1,4.99))}},g={ran:t,ranItem:i,Sides:k,isAbove:e,isBelow:s,isLeft:n,isRight:o,reverseOf:a,toward:r,vecFor:h,hsvToRgb:c,getRandomPointFor:l},m=100,y=1.5,T=.5,w=70,b=20,M=50,S=5e3,C=function(t){function i(t,e){_classCallCheck(this,i),_get(Object.getPrototypeOf(i.prototype),"constructor",this).call(this,t,e),this.options.sparkCount=this.options.sparkCount||m,this.options.maxSparkSize=this.options.maxSparkSize||y,this.options.minSparkSize=this.options.minSparkSize||T,this.options.maxSparkVelocity=this.options.maxSparkVelocity||w,this.options.minSparkVelocity=this.options.minSparkVelocity||b,this.options.sparkCount=this.options.sparkCount||m,this.sparkSource=this.options.sparkSource?this.options.sparkSource:new vec2.fromValues(this.width/2,this.height/5),this.sparks=[];for(var s=0;s<this.options.sparkCount;s++)this.sparks.push(new p({pathRedraw:this.pathRedraw,sparkResolution:4}))}return _inherits(i,t),_createClass(i,[{key:"pathRedraw",value:function(t,i,e,s,n,o){s=1-s;var a=g.hsvToRgb(t.options.color.h,t.options.color.s,t.options.color.l);o.strokeStyle="rgba("+~~(256*a.r)+","+~~(256*a.g)+","+256*~~a.b+","+s+")",o.lineWidth=t.options.size*s,o.beginPath(),o.moveTo(i[0],i[1]),o.lineTo(e[0],e[1]),o.stroke()}},{key:"onFrameHandler",value:function(t){var i=this;this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.sparks.forEach(function(t){t.sparking||i.startSpark(t),i.sparkOnFrame.call(t,i),t.onFrame(i.elapsed,i.ctx)})}},{key:"startSpark",value:function(t){var i=Math.random()-.5-Math.PI/2,e=Math.random()*Math.PI*2,s=Math.random()*M,n=8*Math.random(),o=this.sparkSource;if(o.target){var a=(o.target.getBoundingClientRect(),0),r=0;o.offset&&o.offset.x&&(a=-1!=o.offset.x.indexOf("%")?o.target[o.widthProp]*(parseFloat(o.offset.x)/100):o.offset.x),o.offset&&o.offset.y&&(r=-1!=o.offset.y.indexOf("%")?o.target[o.heightProp]*(parseFloat(o.offset.y)/100):o.offset.y),o=vec2.fromValues(a,r)}t.spark({type:2,size:Math.random()*(this.options.maxSparkSize-this.options.minSparkSize)+this.options.minSparkSize,color:{h:28*Math.random()+20,s:.4*Math.random()+.6,l:1},position:vec2.add(vec2.create(),o,vec2.fromValues(Math.cos(e)*s,Math.sin(e)*s)),velocity:vec2.scale(vec2.create(),vec2.fromValues(Math.cos(i),Math.sin(i)),Math.random()*(this.options.maxSparkVelocity-this.options.minSparkVelocity)+this.options.minSparkVelocity),heatCurrent:0,lastAngleChangeTime:0,glow:.6*Math.random()+.2,flickerSpeed:Math.random(),life:n,lifeTotal:8})}},{key:"sparkOnFrame",value:function(t){var i=Math.random()*S+(t.lastTime-this.options.lastAngleChangeTime);if(i>S){var e=1.047*Math.random()-.5235,s=mat2.create();mat2.rotate(s,s,e),vec2.transformMat2(this.options.velocity,this.options.velocity,s),this.options.lastAngleChangeTime=t.lastTime}this.options.heatCurrent+=Math.random(),this.options.life-=t.elapsed,this.options.color.l=this.options.life/this.options.lifeTotal*this.options.glow;var n=vec2.scaleAndAdd(vec2.create(),this.position,this.options.velocity,t.elapsed);this.next(n),(this.options.life<0||n.y>t.canvas.height+50||n.x<-50||n.y<-50||n.x>t.canvas.width+50)&&this.reset()}},{key:"onMouseMoveHandler",value:function(t){var i=this.canvas.getBoundingClientRect(),e=this.WIDTH/this.canvasTargetWidth;this.sparkSource=vec2.fromValues((t.clientX-i.left)*e,(t.clientY-i.top)*e)}},{key:"onTouchMoveHandler",value:function(t){t.preventDefault();var i=this.canvas.getBoundingClientRect(),e=WIDTH/this.state.canvasTargetWidth;this.sparkSource=vec2.fromValues((t.touches[0].clientX-i.left)*e,(t.touches[0].clientY-i.top)*e)}}]),i}(v);return C});
//# sourceMappingURL=Embers.min.js.map